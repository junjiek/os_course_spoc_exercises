### 描述符特权级DPL、当前特权级CPL和请求特权级RPL的含义是什么？在哪些寄存器中这些字段？对应的访问条件是什么？ (challenge)写出一些简单的小程序（c or asm）来体现这些特权级的区别和联系。
 ```
  + 建议参见链接“ http://blog.csdn.net/better0332/article/details/3416749 ”对特权级的表述，并查阅指令手册。
  - 
 ```

> - CPL(Current Privilege Level)是当前执行的程序或任务的特权级，存在于CS寄存器的第0位和第1位。通常情况下，CPL等于代码的段的特权级。在遇到一致代码段时，一致代码段可以被相同或者更低特权级的代码访问。当处理器访问一个与CPL特权级不同的一致代码段时，CPL不会被改变。
> - RPL（Requested Privilege Level）说明的是进程对段访问的请求权限(Request Privilege Level)，存在于段选择子的第0位和第1位。处理器通过检查RPL和CPL来确认一个访问请求是否合法。
> - DPL(Descriptor Privilege Level)表示段或者门的特权级，它被存储在段描述符或者门描述符的DPL字段中。当进程访问一个段时，需要进程特权级检查，一般要求DPL >= max {CPL, RPL}。(1)数据段：DPL规定了可以访问此段的最低特权级。(2)非一致代码段（不使用调用门的情况下）：DPL规定访问此段的特权级。(3)调用门：DPL规定了当前执行的程序或任务可以访问此调用门的最低特权级（这与数据段的规则是一致的）。 (4)一致代码段和通过调用门访问的非一致代码段：DPL规定了访问此段的最高特权级。

### 比较不同特权级的中断切换时的堆栈变化差别；(challenge)写出一些简单的小程序（c or asm）来显示出不同特权级的的中断切换的堆栈变化情况。

> - 当特权级处于内核态的时候，中断切换时不用变换堆，依然使用内核态的堆，压栈时需要压入EIP，CS，EFLAGS等寄存器参数即可。

<pre><code> 特权级无变化时堆栈情况

      D  O      31          0                     31          0
      I  F    |-------+-------|                 |-------+-------|
      R       |#######|#######|    OLD          |#######|#######|    OLD
      E  E    |-------+-------|   SS:ESP        |-------+-------|   SS:ESP
      C  X    |#######|#######|     |           |#######|#######|     |
      T  P    |-------+-------|&lt;----+           |-------+-------|&lt;----+
      I  A    |  OLD EFLAGS   |                 |  OLD EFLAGS   |
      O  N    |-------+-------|                 |-------+-------|
      N  S    |#######|OLD CS |    NEW          |#######|OLD CS |
         I    |-------+-------|   SS:ESP        |-------+-------|
       | O    |    OLD EIP    |     |           |    OLD EIP    |    NEW
       | N    |---------------|&lt;----+           |---------------|   SS:ESP
       |      |               |                 |  ERROR CODE   |     |
       !      *               *                 |---------------|&lt;----+
              *               *                 |               |
              *               *
              WITHOUT ERROR CODE                 WITH ERROR CODE
</code></pre>



> - 当特权级处于用户态时，首先需要将堆栈从用户态的堆，切换到内核态的堆，压栈时，不仅需要将EIP，CS，EFLAGS等寄存器压栈，同时需要将用户态的可能会改变的寄存器也进行压客栈。


<pre><code>特权级有变化时堆栈变化情况

      D  O     31            0                     31          0
      I  F    +-------+-------+&lt;----+           +-------+-------+&lt;----+
      R       |#######|OLD SS |     |           |#######|OLD SS |     |
      E  E    |-------+-------|   SS:ESP        |-------+-------|   SS:ESP
      C  X    |    OLD ESP    |  FROM TSS       |    OLD ESP    |  FROM TSS
      T  P    |---------------|                 |---------------|
      I  A    |  OLD EFLAGS   |                 |  OLD EFLAGS   |
      O  N    |-------+-------|                 |-------+-------|
      N  S    |#######|OLD CS |    NEW          |#######|OLD CS |
         I    |-------+-------|   SS:EIP        |-------+-------|
       | O    |    OLD EIP    |     |           |    OLD EIP    |    NEW
       | N    |---------------|&lt;----+           |---------------|   SS:ESP
       |      |               |                 |  ERROR CODE   |     |
       !      *               *                 |---------------|&lt;----+
              *               *                 |               |
              *               *
              WITHOUT ERROR CODE                 WITH ERROR CODE
</code></pre>
